# RedBugler
本地热键探测，支持无规则探测热键，也支持根据键的访问量、占比、键总量、总访问次数等规则自动计算是否是热键
分布式热键探测版本有时间再继续开发
## 原理：多轮哈希（Multi - Hashing）
一个缓存项使用多个不同的哈希函数，将其映射到频率草图的多个不同位置。
这样可以使每个缓存项的访问频率信息更均匀地分布在频率草图中，提高频率统计的准确性。

作用：
减少哈希冲突对频率统计的干扰，使频率草图能够更准确地反映每个缓存项的实际访问频率。

## 各方案对比
| 方案                                 | RedBugler                             | JD-hotkey          | caffine                     | Bloom Filter           | 基于时间序列分析的方法                              | 基于机器学习的方法          |
|------------------------------------|---------------------------------------|--------------------|-----------------------------|------------------------|------------------------------------------|--------------------|
| 原理                                 | 多轮哈希（Multi - Hashing）+<br/> 滑动窗口/老化机制 | 滑动窗口               | TinyLfu + 老化机制              | BitMap结合长hash算法        | 使用时间序列分析方法（如 ARIMA 模型、LSTM 模型等）来预测键的访问趋势 | 如基于统计的方法、基于深度学习的方法 |
| 具体实现                               | RedBugler                             | JD-hotkey          | caffine                     | 需要结合开源工具手写             | 未发现开源实现实例                                | 未发现开源实现实例          | 
| 支持分布式                              | 暂未开发                                  | 支持                 | /                           | 可以使用redis Bitmap实现     | /                                        | /                  |
| 性能瓶颈                               | CPU                                   | IO + CPU           | IO + CPU                    | 无                      | 开发测试                                     | GPU/CPU + 人力       |
| 探测规则                               | 动态：依据既往频率占总体的分布                       | 固定阈值：时段内超过阈值       | 固定阈值或固定存储空间：时段内超过阈值或存在      | 固定阈值或固定存储空间：时段内超过阈值或存在 | 动态：依据异常增长趋势                              | 动态:依据值的特征          |
| 本地CPU占用                            | 计算热键、工作线程与探测线程通信                      | 全量键上报              | 计算热键、工作线程与探测线程通信            | 计算热键、工作线程与探测线程通信       | 全量键上报                                    | 多层神经网络计算           |
| 本地内存占用                             | 限量的，每个hash算法计算单元约占40kb                | 热键量+每次全量上报的键量      | 支持热键的数量                     | Bitmap的大小              | 无                                        | 模型大小               |
| 记忆性                                | 部分记忆性，自行定义窗口有效时间                      | 在控制台手写特定键          | 无                           | 记忆能力是此方案的负担，需要定期失忆才可用  | 有                                        | 有                  |
| 问题                                 | 幻觉问题：hash算法少容易出幻觉，多了CPU消耗低延迟高         | 全量键上报IO瓶颈高、分布式成本较高 | 内存占用大、CPU占用高、存键少没作用、存多了容易崩溃 | 基本不可用，无法解决准确性          | 训练和调优比较复杂，维护成本较高                         | 无法及时响应热键的变化、容易出现幻觉 |

